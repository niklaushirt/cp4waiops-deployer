
export APP_NAME=robot-shop
export INDEX_TYPE=changerisk


#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# DO NOT EDIT BELOW
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



if [[  $WAIOPS_NAMESPACE =~ "" ]]; then
    # Get Namespace from Cluster 
    echo "   ------------------------------------------------------------------------------------------------------------------------------"
    echo "   üî¨ Getting Installation Namespace"
    echo "   ------------------------------------------------------------------------------------------------------------------------------"
    export WAIOPS_NAMESPACE=$(oc get po -A|grep aiops-orchestrator-controller |awk '{print$1}')
    echo "       ‚úÖ AI Manager:         OK - $WAIOPS_NAMESPACE"
else
    echo "       ‚úÖ AI Manager:         OK - $WAIOPS_NAMESPACE"
fi




if [[ $ROUTE =~ "ai-platform-api" ]]; then
    echo "       ‚úÖ Platform API Route: OK"
else
    echo "       üõ†Ô∏è   Creating Route"
    oc create route passthrough ai-platform-api -n $WAIOPS_NAMESPACE  --service=aimanager-aio-ai-platform-api-server --port=4000 --insecure-policy=Redirect --wildcard-policy=None
    export ROUTE=$(oc get route -n $WAIOPS_NAMESPACE ai-platform-api  -o jsonpath={.spec.host})
    echo "        Route: $ROUTE"
    echo ""
fi
echo ""


echo "  ***************************************************************************************************************************************************"
echo "   üõ†Ô∏è   Create Analysis Definiton: Temporal Grouping"
export FILE_NAME=create-analysis-TG.graphql
./tools/02_training/scripts/execute-graphql.sh


echo "  ***************************************************************************************************************************************************"
echo "   üõ†Ô∏è   Run Analysis: Temporal Grouping"
export FILE_NAME=run-analysis-TG.graphql
./tools/02_training/scripts/execute-graphql.sh



